swagger: "2.0"
info:
  title: InnerPeace API
  version: "1.0.0"

schemes: ["https"]
produces: ["application/json"]

security:
  - supabase_jwt: []

securityDefinitions:
  supabase_jwt:
    type: oauth2
    flow: implicit
    authorizationUrl: ""
    x-google-issuer: "https://abcd1234.supabase.co/auth/v1"
    x-google-jwks_uri: "https://abcd1234.supabase.co/auth/v1/keys"
    x-google-audiences: "authenticated"
    x-google-jwt-locations:
      - header: "Authorization"
        value_prefix: "Bearer "

paths:
  /healthz:
    get:
      operationId: healthCheck
      security: []
      x-google-backend:
        address: "https://innerpeace-api-379484922687.europe-west2.run.app"
        path_translation: APPEND_PATH_TO_ADDRESS
        jwt_audience: "https://innerpeace-api-379484922687.europe-west2.run.app"
      responses:
        "200": { description: "OK" }

  /api/media/list:
    get:
      operationId: listMedia
      security:
        - supabase_jwt: []
      parameters:
        - { name: folderId, in: query, type: string, required: false }
      x-google-backend:
        address: "https://innerpeace-api-379484922687.europe-west2.run.app"
        path_translation: APPEND_PATH_TO_ADDRESS
        jwt_audience: "https://innerpeace-api-379484922687.europe-west2.run.app"
      responses:
        "200": { description: "OK" }

  /api/media/stream/{id}:
    get:
      operationId: streamMedia
      security:
        - supabase_jwt: []
      parameters:
        - { name: id, in: path, required: true, type: string }
      x-google-backend:
        address: "https://innerpeace-api-379484922687.europe-west2.run.app"
        path_translation: APPEND_PATH_TO_ADDRESS
        jwt_audience: "https://innerpeace-api-379484922687.europe-west2.run.app"
      responses:
        "200": { description: "OK" }
        "206": { description: "Partial content" }

  /api/bookings:
    get:
      operationId: listBookings
      security:
        - supabase_jwt: []
      parameters:
        - { name: uid, in: query, type: string, required: false }
      x-google-backend:
        address: "https://innerpeace-api-379484922687.europe-west2.run.app"
        path_translation: APPEND_PATH_TO_ADDRESS
        jwt_audience: "https://innerpeace-api-379484922687.europe-west2.run.app"
      responses:
        "200": { description: "OK" }
    post:
      operationId: createBooking
      security:
        - supabase_jwt: []
      x-google-backend:
        address: "https://innerpeace-api-379484922687.europe-west2.run.app"
        path_translation: APPEND_PATH_TO_ADDRESS
        jwt_audience: "https://innerpeace-api-379484922687.europe-west2.run.app"
      responses:
        "200": { description: "OK" }

  /api/bookings/{id}:
    delete:
      operationId: deleteBooking
      security:
        - supabase_jwt: []
      parameters:
        - { name: id, in: path, required: true, type: string }
      x-google-backend:
        address: "https://innerpeace-api-379484922687.europe-west2.run.app"
        path_translation: APPEND_PATH_TO_ADDRESS
        jwt_audience: "https://innerpeace-api-379484922687.europe-west2.run.app"
      responses:
        "200": { description: "OK" }
    put:
      operationId: updateBooking
      security:
        - supabase_jwt: []
      parameters:
        - { name: id, in: path, required: true, type: string }
      x-google-backend:
        address: "https://innerpeace-api-379484922687.europe-west2.run.app"
        path_translation: APPEND_PATH_TO_ADDRESS
        jwt_audience: "https://innerpeace-api-379484922687.europe-west2.run.app"
      responses:
        "200": { description: "OK" }

  /api/availability:
    get:
      operationId: getAvailability
      security:
        - supabase_jwt: []
      parameters:
        - { name: start, in: query, type: string, required: false }
        - { name: end, in: query, type: string, required: false }
      x-google-backend:
        address: "https://innerpeace-api-379484922687.europe-west2.run.app"
        path_translation: APPEND_PATH_TO_ADDRESS
        jwt_audience: "https://innerpeace-api-379484922687.europe-west2.run.app"
      responses:
        "200": { description: "OK" }

  /api/youtube/channel/{id}:
    get:
      operationId: getYoutubeChannel
      security: []
      parameters:
        - { name: id, in: path, required: true, type: string }
      x-google-backend:
        address: "https://innerpeace-api-379484922687.europe-west2.run.app"
        path_translation: APPEND_PATH_TO_ADDRESS
        jwt_audience: "https://innerpeace-api-379484922687.europe-west2.run.app"
      responses:
        "200": { description: "OK" }
